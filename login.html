<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login | HireFlow</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:'Inter',sans-serif;
  background:linear-gradient(135deg,#2557a7,#1e3c72);
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

.container{
  display:flex;
  width:900px;
  background:white;
  border-radius:14px;
  overflow:hidden;
  box-shadow:0 20px 50px rgba(0,0,0,0.25);
}

.left{
  flex:1;
  padding:60px;
  background:#f4f6fb;
  display:flex;
  flex-direction:column;
  justify-content:center;
}

.left h1{
  font-size:28px;
  margin-bottom:10px;
}

.left p{
  color:#555;
  margin-bottom:30px;
}

input{
  width:100%;
  padding:14px;
  margin-bottom:18px;
  border-radius:8px;
  border:1px solid #ddd;
  font-size:14px;
}

button{
  width:100%;
  padding:14px;
  background:#2557a7;
  color:white;
  border:none;
  border-radius:8px;
  font-weight:600;
  cursor:pointer;
}

button:hover{
  background:#1e3c72;
}

.right{
  flex:1;
  background:url('https://images.unsplash.com/photo-1551434678-e076c223a692?q=80&w=1600') center/cover;
}

.footer{
  margin-top:20px;
  font-size:14px;
}

.footer a{
  color:#2557a7;
  text-decoration:none;
}

.error{
  color:red;
  margin-top:10px;
}

@media(max-width:900px){
  .container{flex-direction:column;width:95%;}
  .right{height:200px;}
}
</style>
</head>
<body>

<div class="container">

<div class="left">
  <h1>Welcome Back ðŸ‘‹</h1>
  <p>Login to manage jobs, applications and referrals.</p>

  <input type="email" id="email" placeholder="Email address">
  <input type="password" id="password" placeholder="Password">

  <button onclick="login()">Sign In</button>
  <p class="error" id="error"></p>

  <div class="footer">
    Donâ€™t have an account? <a href="register.html">Create one</a>
  </div>
</div>

<div class="right"></div>

</div>

<script>
const API = "https://backend-1-9b6f.onrender.com";

async function login(){
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  const errorBox = document.getElementById("error");

  errorBox.innerText = "Signing in...";
  
  try{
    const res = await fetch(API + "/api/auth/login",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({email,password})
    });

    const data = await res.json();

    if(res.ok && data.token){
      localStorage.setItem("token", data.token);
      localStorage.setItem("role", data.user.role);

      if(data.user.role === "admin"){
        window.location.href = "admin.html";
      }else if(data.user.role === "employer"){
        window.location.href = "employer.html";
      }else if(data.user.role === "talent"){
        window.location.href = "talent.html";
      }else if(data.user.role === "agent"){
        window.location.href = "agent.html";
      }

    }else{
      errorBox.innerText = data.message || "Invalid credentials";
    }

  }catch(err){
    errorBox.innerText = "Server is waking up... please try again in 20 seconds.";
  }
}
</script>


</body>
</html>
